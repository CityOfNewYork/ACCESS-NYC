/*! Content Workflow (by Bynder) - v1.0.0 - 2024-06-25 |  | Copyright (c) 2024 Content Workflow (by Bynder) | Licensed GPLv2 */
!function s(n,a,l){function o(i,e){if(!a[i]){if(!n[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(r)return r(i,!0);e=new Error("Cannot find module '"+i+"'");throw e.code="MODULE_NOT_FOUND",e}t=a[i]={exports:{}};n[i][0].call(t.exports,function(e){var t=n[i][1][e];return o(t||e)},t,t.exports,s,n,a,l)}return a[i].exports}for(var r="function"==typeof require&&require,e=0;e<l.length;e++)o(l[e]);return o}({1:[function(e,t,i){"use strict";t.exports=Backbone.Collection.extend({getById:function(t){return this.find(function(e){e=e.get("id");return e===t||e&&t&&e==t})}})},{}],2:[function(e,t,i){"use strict";t.exports=function(e){return e.collections.base.extend({model:e.models.tabRow,initialize:function(e,t){this.tab=t.tab}})}},{}],3:[function(e,t,i){"use strict";t.exports=function(e){return e.collections.base.extend({model:e.models.tab})}},{}],4:[function(t,e,i){"use strict";e.exports=function(e){e.models={base:t("./models/base.js")},e.collections={base:t("./collections/base.js")},e.views={base:t("./views/base.js")}}},{"./collections/base.js":1,"./models/base.js":6,"./views/base.js":10}],5:[function(e,t,i){"use strict";var s,n,a;window.GatherContent=window.GatherContent||{},window,document,s=jQuery,(n=window.GatherContent).mapping=n.mapping||{},a=n.mapping,e("./initiate-objects.js")(a),a.views.statusSelect2=e("./views/status-select2.js")(a),a.models.tabRow=e("./models/tab-row.js")(a,n),a.collections.tabRows=e("./collections/tab-rows.js")(a),a.views.tabRow=e("./views/tab-row.js")(a,n._meta_keys),a.models.tab=e("./models/tab.js")(a,n._table_headings),a.collections.tabs=e("./collections/tabs.js")(a),a.views.tab=e("./views/tab.js")(a),a.views.tabLink=e("./views/tab-link.js")(a),a.views.defaultTab=e("./views/default-tab.js")(a,n._table_headings),a.views.tabs=e("./views/tabs.js")(a,s,n),a.init=function(){a.mappingView=new a.views.tabs({collection:new a.collections.tabs(n._tabs)})},s(a.init)},{"./collections/tab-rows.js":2,"./collections/tabs.js":3,"./initiate-objects.js":4,"./models/tab-row.js":8,"./models/tab.js":9,"./views/default-tab.js":11,"./views/status-select2.js":12,"./views/tab-link.js":13,"./views/tab-row.js":14,"./views/tab.js":15,"./views/tabs.js":16}],6:[function(e,t,i){"use strict";t.exports=Backbone.Model.extend({sync:function(){return!1}})},{}],7:[function(e,t,i){"use strict";t.exports=function(e){return e.prototype._get=function(e,t){return e=this["_get_"+t]?this["_get_"+t](e):e},e.prototype.get=function(e){return this._get(Backbone.Model.prototype.get.call(this,e),e)},e.prototype.toJSON=function(){return _.mapObject(Backbone.Model.prototype.toJSON.call(this),_.bind(this._get,this))},e}},{}],8:[function(e,t,i){"use strict";t.exports=function(t,i){return e("./../models/modify-json.js")(t.models.base.extend({defaults:{id:"",label:"",name:"",field_type:"",type:"",typeName:"",post_type:"post",field_value:!1,field_field:!1,field_subfields:!1,expanded:!1,required:!1,value:"",microcopy:"",limit_type:"",limit:0,plain_text:!1},_get_post_type:function(e){return t.mappingView?t.mappingView.defaultTab.get("post_type"):e},_get_type:function(e){return e="text"===e?this.get("plain_text")?"text_plain":"text_rich":e},_get_typeName:function(e){return e=this.get("type"),i._type_names[e]||e}}))}},{"./../models/modify-json.js":7}],9:[function(e,t,i){"use strict";t.exports=function(e,t){return e.models.base.extend({defaults:{id:"",label:"",hidden:!1,navClasses:"",rows:[],table_id:"",col_headings:t.default},initialize:function(){this.rows=new e.collections.tabRows(this.get("rows"),{tab:this}),this.listenTo(this.rows,"change",this.triggerRowChange)},triggerRowChange:function(e){this.trigger("rowChange",e)}})}},{}],10:[function(e,t,i){"use strict";t.exports=Backbone.View.extend({toggleExpanded:function(e){this.model.set("expanded",!this.model.get("expanded"))},getRenderedModels:function(t,e){e=e||this.collection;var i=document.createDocumentFragment();return e.each(function(e){e=new t({model:e}).render();i.appendChild(e.el)}),i},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},close:function(){this.remove(),this.unbind(),this.onClose&&this.onClose()}})},{}],11:[function(e,t,i){"use strict";t.exports=function(i,s){return i.views.tab.extend({events:{"change select":"changeDefault","click .gc-reveal-items":"toggleExpanded"},defaultTabTemplate:wp.template("gc-mapping-defaults-tab"),statusMappingsTemplate:wp.template("gc-mapping-defaults-tab-status-mappings"),changeDefault:function(e){var e=jQuery(e.target),t=e.val(),i=e.data("column");t&&(e.data("select2")&&(e=e.select2("data")[0]).text&&this.model.set("select2:"+i+":"+t,e.text),this.model.set(i,t))},render:function(){var e=this.model.toJSON();return this.$el.html(this.htmlWrap(e)),this.$el.find("tbody").first().html(this.defaultTabTemplate(e)),this.$el.find("#gc-status-mappings tbody").html(this.statusMappingsTemplate(e)),this.renderSelect2(),this},htmlWrap:function(e){var t=this.template(e);return this.model.get("initial")||(e.table_id="gc-status-mappings",delete e.label,e.col_headings=s.status,t=(t+="<br>")+this.template(e)),t},select2Args:function(t){var e={};switch(t.column){case"gc_status":e=i.views.statusSelect2.prototype.select2Args.call(this,t);break;case"post_author":e.width="250px",e.minimumInputLength=2,e.ajax={url:t.url,data:function(e){return{q:e.term,column:t.column}},delay:250,cache:!0}}return e}})}},{}],12:[function(e,t,i){"use strict";t.exports=function(e){var s;return e.views.base.extend({select2ItemTemplate:wp.template("gc-select2-item"),width:"250px",renderSelect2:function(e){e=e?e.find(".gc-select2"):this.$(".gc-select2");return s=this,e.each(function(){var e=jQuery(this),t=e.data(),e=(e.select2(s.select2Args(t)),e.data("select2"));e.$results.addClass("select2-"+t.column),e.$container.addClass("select2-"+t.column)}),this},select2Args:function(e){var t={width:s.width};return t.templateResult=function(e,t){var i=jQuery.extend(e,jQuery(e.element).data());return i.description=!1!==t&&(i.description||""),jQuery(s.select2ItemTemplate(e))}.bind(s),t.templateSelection=function(e){return t.templateResult(e,!1)},t}})}},{}],13:[function(e,t,i){"use strict";t.exports=function(e){return e.views.base.extend({tagName:"a",id:function(){return"tabtrigger-"+this.model.get("id")},className:function(){return"nav-tab "+(this.model.get("hidden")?"":"nav-tab-active")+" "+this.model.get("navClasses")},render:function(){return this.$el.text(this.model.get("label")).attr("href","#"+this.model.get("id")),this}})}},{}],14:[function(e,t,i){"use strict";t.exports=function(e,t){return e.views.base.extend({tagName:"tr",template:wp.template("gc-mapping-tab-row"),events:{"change .wp-type-select":"changeType","change .wp-type-value-select":"changeValue","change .wp-type-field-select":"changeField","change .wp-subfield-select":"changeSubfield","click  .gc-reveal-items":"toggleExpanded"},initialize:function(){this.listenTo(this.model,"change:field_type",this.render),this.metaKeys=new(e.collections.base.extend({model:e.models.base.extend({defaults:{value:"",field:"",subfields:""}}),getByValue:function(t){return this.find(function(e){return e.get("value")===t})},getByField:function(t){return this.find(function(e){return e.get("field")===t})},getBySubfields:function(t){return this.find(function(e){return e.get("subfields")===t})}}))(t)},changeType:function(e){this.model.set("field_type",jQuery(e.target).val())},changeValue:function(e){var t=jQuery(e.target).closest(".component-table-wrapper").attr("id"),i=jQuery(e.target).val(),s=this.model.get("type"),n=this.model.get("field_type");""===i?(this.model.set("field_type",""),this.model.set("field_value",""),this.model.set("field_field",""),this.model.set("field_subfields",{}),jQuery("#"+t+" .component-table-inner ").find("select").html("<option value=''>Unused</option>").val("")):(this.model.set("field_value",i),"component"===s?this.updateAjax_Field(t,i,!1):"wp-type-acf"===n&&(s=jQuery(e.target).closest("td").attr("id"),this.updateAjax_Field(s,i,!1)))},changeField:function(e){var t=jQuery(e.target).val(),e=jQuery(e.target).closest(".component-table-wrapper").attr("id");this.model.set("field_subfields",{}),""===t?(this.model.set("field_field",""),jQuery("#"+e+" .component-table-inner ").find("select").html("<option value=''>Unused</option>").val("")):(this.model.set("field_field",t),this.updateAjax_ComponentSubfields(e,t,!1))},changeSubfield:function(e){var t=jQuery(e.target).val(),e=jQuery(e.target).attr("data-index"),i=this.model.get("field_subfields");(i=i||{})[e]=t,this.model.set("field_subfields",i)},optionBuilder:function(e){var i="<option value=''>Unused</option>";return jQuery.each(e.field_data,function(e,t){i+="<option class='hidden' value='"+t.key+"' data-type='"+t.type+"'>"+t.label+"</option>"}),i},updateAjax_Field:function(t,e,i){i=void 0!==i?i:"";var s=this;jQuery("#"+t+" .wp-type-field-select ~ span.select2").addClass("ajax-disabled"),jQuery.post(window.ajaxurl,{action:"cwby_component_subfields",subfields_data:{name:e}},function(e){jQuery("#"+t+" .wp-type-field-select ~ span.select2").removeClass("ajax-disabled"),e.success?e.data.field_data&&e.data.field_data.length&&(e=s.optionBuilder(e.data),jQuery("#"+t).find(".wp-type-field-select").html(e),i)&&jQuery("#"+t).find(".wp-type-field-select").val(i):window.alert("Please refresh and try again. If the issue persists, reach out to support")})},updateAjax_ComponentSubfields:function(t,e,i){i=void 0!==i?i:{};var s=this;jQuery("#"+t+" .component-table-inner").find("select").addClass("ajax-disabled"),jQuery.post(window.ajaxurl,{action:"cwby_component_subfields",subfields_data:{name:e}},function(e){jQuery("#"+t+" .component-table-inner").find("select").removeClass("ajax-disabled"),e.success?e.data.field_data&&e.data.field_data.length?(e=s.optionBuilder(e.data),jQuery("#"+t).find(".component-table-inner select").html(e),Object.keys(i).length&&(e=jQuery("#"+t).find(".component-table-inner select").toArray(),jQuery.each(e,function(e,t){e++,jQuery(t).val(i[e])}))):window.alert("The chosen field is not a repeater field and therefore not compatible with Content Workflow components"):window.alert("Please refresh and try again. If the issue persists, reach out to support")})},render:function(){var e=this.model.get("field_value"),t=this.model.get("field_field"),i=this.model.get("field_subfields"),e=(e&&!this.metaKeys.getByValue(e)&&this.metaKeys.add({value:e}),t&&!this.metaKeys.getByField(t)&&this.metaKeys.add({field:t}),i&&!this.metaKeys.getBySubfields(i)&&this.metaKeys.add({subfields:i}),t&&(e=this.model.get("name"),i)&&this.updateAjax_ComponentSubfields(e,t,i),this.model.toJSON());return e.metaKeys=this.metaKeys.toJSON(),this.$el.html(this.template(e)),this.$(".gc-select2").each(function(){var e=jQuery(this),t={width:"250px"};e.hasClass("gc-select2-add-new")&&(t.tags=!0),e.select2(t)}),this}})}},{}],15:[function(e,t,i){"use strict";t.exports=function(t){return t.views.statusSelect2.extend({template:wp.template("gc-tab-wrapper"),tagName:"fieldset",id:function(){return this.model.get("id")},className:function(){return"gc-template-tab "+(this.model.get("hidden")?"hidden":"")},render:function(){this.$el.html(this.template(this.model.toJSON()));var e=this.getRenderedModels(t.views.tabRow,this.model.rows);return this.$el.find("tbody").html(e),this}})}},{}],16:[function(e,t,i){"use strict";t.exports=function(s,n,a){return s.views.base.extend({initial:a._initial,el:"#mapping-tabs",template:wp.template("gc-tabs-wrapper"),events:{"click .nav-tab":"tabClick","click .nav-tab-link":"triggerClick"},initialize:function(){this.listenTo(this.collection,"render",this.render),this.listenTo(this,"render",this.render),this.listenTo(this,"saveEnabled",this.enableSave),this.listenTo(this,"saveDisabled",this.disableSave),this.initial&&this.listenTo(this.collection,"change:post_type",this.initMapping),this.defaultTab=this.collection.getById("mapping-defaults"),this.render(),!this.initial&&a._pointers.refresh_connection&&window.setTimeout(function(){this.pointer(n(".submit .gc-refresh-connection"),"refresh_connection",{position:{edge:"top"}}),n(".gc-wp-pointer.refresh_connection").css({"margin-left":"-41px"})}.bind(this),500)},initMapping:function(){var e;this.initial=!1,this.stopListening(this.collection,"change:post_type",this.initMapping),this.listenTo(this.collection,"rowChange",this.triggerSaveEnabled),this.defaultTab.set("initial",this.initial),this.render(),a._tabs&&0<a._tabs.length&&(e=a._tabs[0].id)&&(this.setTab(e),this.$('.nav-tab[href="#'+e+'"]').trigger("click")),a._pointers.select_tab_how_to&&(this.pointer(".gc-nav-tab-wrapper-bb","select_tab_how_to"),this.pointer("#gc-status-mappings","map_status_how_to"))},triggerSaveEnabled:function(e){e.changed.field_value&&(this.trigger("saveEnabled"),this.stopListening(this.collection,"rowChange"))},triggerClick:function(e){e.preventDefault(),this.$('.nav-tab[href="'+n(e.target).attr("href")+'"]').trigger("click")},tabClick:function(e){e.preventDefault(),this.setTab(n(e.target).attr("href").substring(1)),this.render()},setTab:function(e){this.$el.attr("class",e),this.collection.invoke("set",{hidden:!0}),this.collection.getById(e).set("hidden",!1)},render:function(){return this.$(".gc-select2").each(function(){n(this).select2("destroy")}),this.$el.html(this.template()),this.renderNav(),this.renderTabs(),this.initial&&this.renderInitial(),this},renderNav:function(){var e=this.initial?(this.setTab(this.defaultTab.get("id")),new s.views.tabLink({model:this.defaultTab}).render().el):this.getRenderedModels(s.views.tabLink);this.$el.find(".nav-tab-wrapper").append(e)},renderTabs:function(){var e,i=document.createDocumentFragment();this.initial?(this.defaultTab.set("initial",this.initial),e=new s.views.defaultTab({model:this.defaultTab}),i.appendChild(e.render().el)):this.collection.each(function(e){var t="mapping-defaults"===e.get("id")?"defaultTab":"tab",t=new s.views[t]({model:e});i.appendChild(t.render().el)}),this.$el.find(".gc-template-tab-group").append(i)},renderInitial:function(){this.pointer('[data-column="post_type"]',"select_type",{dismissable:!1,position:{edge:"bottom",align:"left"}}),this.trigger("saveDisabled")},enableSave:function(){n(".submit .button-primary").prop("disabled",!1)},disableSave:function(){n(".submit .button-primary").prop("disabled",!0)},pointer:function(e,t,i){var s={content:a._pointers[t],pointerClass:"wp-pointer gc-wp-pointer "+t};return!1!==(i=i||{}).dismissable&&(s.close=function(){n.post(window.ajaxurl,{pointer:"gc_"+t,action:"dismiss-wp-pointer"})}),i.position&&(s.position=i.position),(e=e instanceof jQuery?e:this.$(e)).pointer(s).pointer("open")}})}},{}]},{},[5]);