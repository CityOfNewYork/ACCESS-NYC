/*! Content Workflow (by Bynder) - v1.0.0 - 2024-06-25 |  | Copyright (c) 2024 Content Workflow (by Bynder) | Licensed GPLv2 */
!function i(n,c,o){function r(s,e){if(!c[s]){if(!n[s]){var t="function"==typeof require&&require;if(!e&&t)return t(s,!0);if(a)return a(s,!0);e=new Error("Cannot find module '"+s+"'");throw e.code="MODULE_NOT_FOUND",e}t=c[s]={exports:{}};n[s][0].call(t.exports,function(e){var t=n[s][1][e];return r(t||e)},t,t.exports,i,n,c,o)}return c[s].exports}for(var a="function"==typeof require&&require,e=0;e<o.length;e++)r(o[e]);return r}({1:[function(e,t,s){"use strict";t.exports=Backbone.Collection.extend({getById:function(t){return this.find(function(e){e=e.get("id");return e===t||e&&t&&e==t})}})},{}],2:[function(t,e,s){"use strict";e.exports=function(e){var s=null,i="asc",e=e.collections.base.extend({model:e.models.item,totalChecked:0,allChecked:!1,syncEnabled:!1,processing:!1,sortKey:s,sortDirection:i,initialize:function(e,t){this.listenTo(this,"checkAll",this.toggleChecked),this.listenTo(this,"checkSome",this.toggleCheckedIf),this.listenTo(this,"change:checked",this.checkChecked),this.listenTo(this,"sortByColumn",this.sortByColumn),this.totalChecked=this.checked().length,t&&t.reinit&&this.reinit(e)},reinit:function(e){this.totalChecked=this.checked(e).length,this.syncEnabled=0<this.totalChecked,this.allChecked=this.totalChecked>=e.length,this.sortKey=s,this.sortDirection=i,this.sort()},checkChecked:function(e){e.changed.checked?this.totalChecked++:(this.totalChecked===this.length&&(this.allChecked=!1),this.totalChecked--),this.checkAllStatus()},checkAllStatus:function(e){var t=this.syncEnabled;this.syncEnabled=0<this.totalChecked,t!==this.syncEnabled&&this.trigger("enabledChange",this.syncEnabled),this.totalChecked<this.length&&this.trigger("notAllChecked",!1)},toggleCheckedIf:function(t){this.processing=!0,this.stopListening(this,"change:checked",this.checkChecked),this.each(function(e){e.set("checked",Boolean("function"==typeof t?t(e):t))}),this.listenTo(this,"change:checked",this.checkChecked),this.totalChecked=this.checked().length,this.allChecked=this.totalChecked>=this.length,this.checkAllStatus(),this.processing=!1,this.trigger("render")},toggleChecked:function(e){this.allChecked=e,this.toggleCheckedIf(e)},checked:function(e){return(e=e||this).filter(function(e){return e.get("checked")})},comparator:function(e,t){if(this.sortKey)return e=e.get(this.sortKey),t=t.get(this.sortKey),"updated_at"===this.sortKey&&(e=e.date||e,t=t.date||t),"status"===this.sortKey&&(e=e.name||e,t=t.name||t),"asc"===this.sortDirection?t<e?-1:e<t?1:0:e<t?-1:t<e?1:0},sortByColumn:function(e,t){this.sortKey=s=e,this.sortDirection=i=t,this.sort()}});return t("./../collections/search-extension.js")(e)}},{"./../collections/search-extension.js":3}],3:[function(e,t,s){"use strict";t.exports=function(n){return _.extend(n.prototype,{_searchResults:null,search:function(e,t){e=this._doSearch(e,t);return this.trigger("search",e),e},_doSearch:function(s,e){var i,t;return e=!(!e||!e.length)&&e,this.models.length?(i=this.matcher,t=s?this.filter(function(t){return e=e||t.searchAttributes||_.keys(t.attributes),_.some(e,function(e){return i(s,t.get(e))})}):this.models,this.trigger("searchResults",t),(t=new n(t,{reinit:!0})).searching={keyword:s,attributes:e},t.getSearchQuery=function(){return this.searching},this._searchResults=t,this.trigger("search",t),t):[]},matcher:function(e,t){if(e&&t)return e=e.toString().toLowerCase(),0<=(t=t.toString().toLowerCase()).indexOf(e)},getSearchValue:function(){return this.getSearchQuery().keyword},getSearchQuery:function(){return this._searchResults&&this._searchResults.getSearchQuery()||{}},getSearchResults:function(){return this._searchResults},current:function(){return this._searchResults||this}}),n}},{}],4:[function(t,e,s){"use strict";e.exports=function(e){e.models={base:t("./models/base.js")},e.collections={base:t("./collections/base.js")},e.views={base:t("./views/base.js")}}},{"./collections/base.js":1,"./models/base.js":6,"./views/base.js":10}],5:[function(e,t,s){"use strict";t.exports=function(e,t){return t=jQuery.extend({},{action:"cwby_sync_items",data:"",percent:0,nonce:"",id:"",stopSync:!0,flush_cache:!1},t),e.models.base.extend({defaults:t,initialize:function(){this.listenTo(this,"send",this.send)},reset:function(){return this.clear().set(this.defaults),this},send:function(t,s,e,i){return e&&this.set("percent",e),jQuery.post(window.ajaxurl,{action:this.get("action"),percent:this.get("percent"),nonce:this.get("nonce"),id:this.get("id"),data:t,flush_cache:this.get("flush_cache")},function(e){return this.trigger("response",e,t),e.success?s(e):i?i(e):void 0}.bind(this)),this}})}},{}],6:[function(e,t,s){"use strict";t.exports=Backbone.Model.extend({sync:function(){return!1}})},{}],7:[function(s,e,t){"use strict";e.exports=function(e,t){return s("./../models/modify-json.js")(e.models.base.extend({defaults:{id:0,item:0,itemName:0,project_id:0,parent_id:0,template_id:0,custom_state_id:0,position:0,name:"",config:"",notes:"",type:"",typeName:"",overdue:!1,archived_by:"",archived_at:"",created_at:null,updated_at:null,status:null,due_dates:null,expanded:!1,checked:!1,post_title:!1,ptLabel:!1},searchAttributes:["itemName","post_title"],_get_item:function(e){return this.get("id")},_get_typeName:function(e){return e=e||Backbone.Model.prototype.get.call(this,"type"),t._type_names[e]||e}}))}},{"./../models/modify-json.js":8}],8:[function(e,t,s){"use strict";t.exports=function(e){return e.prototype._get=function(e,t){return e=this["_get_"+t]?this["_get_"+t](e):e},e.prototype.get=function(e){return this._get(Backbone.Model.prototype.get.call(this,e),e)},e.prototype.toJSON=function(){return _.mapObject(Backbone.Model.prototype.toJSON.call(this),_.bind(this._get,this))},e}},{}],9:[function(e,t,s){"use strict";var i,n,c,o,r;window.GatherContent=window.GatherContent||{},i=window,n=document,c=jQuery,(o=window.GatherContent).sync=o.sync||{},r=o.sync,e("./initiate-objects.js")(r),r.views.tableBase=e("./views/table-base.js")(r,c,o),r.models.item=e("./models/item.js")(r,o),r.collections.items=e("./collections/items.js")(r),r.views.item=e("./views/item.js")(r),r.views.items=e("./views/items.js")(r,c,o),r.init=function(){r.syncView=new r.views.items({el:c(".gc-admin-wrap"),collection:new r.collections.items(o._items)}),c(n.body).on("click","#setting-error-gc-import-last-error .notice-dismiss, #setting-error-gc-import-errors .notice-dismiss",function(){var e=0<c(this).parents("#setting-error-gc-import-last-error").length;c.post(i.ajaxurl,{action:"cwby_dismiss_notice",lastError:e?1:0,mapping:o.queryargs.mapping},function(e){o.log("response",e)})}).on("click",".gc-notice-dismiss",function(){c(this).parents(".notice.is-dismissible").find(".notice-dismiss").trigger("click")})},c(r.init)},{"./collections/items.js":2,"./initiate-objects.js":4,"./models/item.js":7,"./views/item.js":11,"./views/items.js":12,"./views/table-base.js":13}],10:[function(e,t,s){"use strict";t.exports=Backbone.View.extend({toggleExpanded:function(e){this.model.set("expanded",!this.model.get("expanded"))},getRenderedModels:function(t,e){e=e||this.collection;var s=document.createDocumentFragment();return e.each(function(e){e=new t({model:e}).render();s.appendChild(e.el)}),s},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},close:function(){this.remove(),this.unbind(),this.onClose&&this.onClose()}})},{}],11:[function(e,t,s){"use strict";t.exports=function(e){return e.views.base.extend({template:wp.template("gc-item"),tagName:"tr",className:"gc-item gc-enabled",id:function(){return this.model.get("id")},events:{"change .gc-check-column input":"toggleCheck","click .gc-reveal-items":"toggleExpanded","click .gc-status-column":"toggleCheckAndRender"},initialize:function(){this.listenTo(this.model,"change:checked",this.render)},toggleCheck:function(){this.model.set("checked",!this.model.get("checked"))},toggleCheckAndRender:function(e){this.toggleCheck(),this.render()}})}},{}],12:[function(c,e,t){"use strict";e.exports=function(t,e,s){var i,n=s.percent;return t.views.tableSearch=c("./../views/table-search.js")(t,e,s),t.views.tableNav=c("./../views/table-nav.js")(t,e,s),t.views.tableBase.extend({template:wp.template("gc-items-sync"),progressTemplate:wp.template("gc-items-sync-progress"),modelView:t.views.item,events:{"click .gc-cancel-sync":"clickCancelSync","click .gc-field-th.sortable":"sortRowsByColumn","change .gc-field-th.gc-check-column input":"checkAll","submit form":"submit"},initialize:function(){i=this,t.views.tableBase.prototype.initialize.call(this),this.listenTo(this.ajax,"response",this.ajaxResponse),this.listenTo(this.collection,"enabledChange",this.checkEnableButton),this.listenTo(this.collection,"search",this.initRender),this.initRender()},setupAjax:function(){var e=c("./../models/ajax.js")(t,{checkHits:0,time:500,nonce:s.el("_wpnonce").value,id:s.el("gc-input-mapping_id").value,flush_cache:s.queryargs.flush_cache?1:0});this.ajax=new e({percent:n})},checkEnableButton:function(e){this.buttonStatus(e)},clickCancelSync:function(e){e.preventDefault(),this.cancelSync()},submit:function(e){e.preventDefault(),this.startSync(this.$("form").serialize())},startSync:function(e){this.doSpinner(),this.ajax.reset().set("stopSync",!1),this.renderProgress(100===window.parseInt(n,10)?0:n),this.doAjax(e,n)},cancelSync:function(e){n=null,this.ajax.reset(),this.clearTimeout(),e?this.doAjax("cancel",0,function(){window.location.href=e}):(this.doAjax("cancel",0,function(){}),this.initRender())},doAjax:function(e,t,s){s=s||this.ajaxSuccess.bind(this),this.ajax.send(e,s,t)},ajaxSuccess:function(e){var t;this.ajax.get("stopSync")||(n=e.data.percent||1,e=this.checkHits(),t=this.ajax.get("time"),25<e&&t<2e3?(this.clearTimeout(),this.ajax.set("time",2e3)):50<e&&t<5e3&&(this.clearTimeout(),this.ajax.set("time",5e3)),this.setTimeout(this.checkProgress.bind(this)),99<n?(this.renderProgressUpdate(100),window.setTimeout(function(){i.renderProgress(100,!0)},100),this.cancelSync(window.location.href+"&updated=1&flush_cache=1&redirect=1")):this.renderProgressUpdate(n))},setTimeout:function(e){this.timeoutID=window.setTimeout(e,this.ajax.get("time"))},checkProgress:function(){this.doAjax("check",n)},checkHits:function(){return window.parseInt(this.ajax.get("checkHits"),10)},ajaxResponse:function(e,t){s.log("warn","hits/interval/response: "+this.checkHits()+"/"+this.ajax.get("time")+"/",e.success?e.data:e),"check"===t?this.ajax.set("checkHits",this.checkHits()+1):e.data&&this.ajax.set("checkHits",0),e.success||(this.renderProgressUpdate(0),this.cancelSync(),e.data&&(e.data.url?(window.alert(e.data.message),window.location.href=e.data.url):window.alert(e.data)))},renderProgressUpdate:function(e){this.$(".gc-progress-bar-partial").css({width:e+"%"}).find("span").text(e+"%")},renderProgress:function(e,t){this.$el.addClass("gc-sync-progress"),this.buttonStatus(!1),this.$("#sync-tabs").html(this.progressTemplate({percent:null===e?0:e,loader:!0===t}))},renderRows:function(e){this.$("#sync-tabs tbody").html(e||this.getRenderedRows())},sortRender:function(){this.initRender()},initRender:function(){var e=this.collection.current();0<n&&n<100?this.startSync("check"):(this.$("#sync-tabs").html(this.template({checked:e.allChecked,sortKey:e.sortKey,sortDirection:e.sortDirection})),this.render())},render:function(){return this.$el.removeClass("gc-sync-progress"),t.views.tableBase.prototype.render.call(this)}})}},{"./../models/ajax.js":5,"./../views/table-nav.js":14,"./../views/table-search.js":15}],13:[function(s,e,t){"use strict";e.exports=function(e,n,t){return e.views.tableSearch=s("./../views/table-search.js")(e,n,t),e.views.tableNav=s("./../views/table-nav.js")(e,n,t),e.views.base.extend({timeoutID:null,ajax:null,tableNavView:null,searchView:null,modelView:null,timeoutTime:1e3,events:{"click .gc-field-th.sortable":"sortRowsByColumn","change .gc-field-th.gc-check-column input":"checkAll"},initialize:function(){this.setupAjax(),this.listenTo(this.collection,"render",this.render),this.listenTo(this.collection,"notAllChecked",this.allCheckedStatus),this.listenTo(this.collection,"change:checked",this.renderNav),this.listenTo(this,"render",this.render),this.tableNavView=new e.views.tableNav({collection:this.collection}),this.searchView=new e.views.tableSearch({collection:this.collection})},setupAjax:function(){},sortRowsByColumn:function(e){e.preventDefault();var t=this.collection.current(),e=n(e.currentTarget),s=e.find("a").data("id"),i=!1;e.hasClass("asc")&&(i="desc"),"asc"===(i=(i=e.hasClass("desc")?"asc":i)||t.sortDirection)?e.addClass("desc").removeClass("asc"):e.addClass("asc").removeClass("desc"),t.trigger("sortByColumn",s,i),this.sortRender()},buttonStatus:function(e){this.$(".button-primary").prop("disabled",!e)},allCheckedStatus:function(){this.$(".gc-field-th.gc-check-column input").prop("checked",this.collection.allChecked)},checkAll:function(e){this.collection.trigger("checkAll",n(e.target).is(":checked"))},doSpinner:function(){var e=this.blankRow('<span class="gc-loader spinner is-active"></span>');this.renderRows(e)},setTimeout:function(e){this.timeoutID=window.setTimeout(e,this.timeoutTime)},clearTimeout:function(){window.clearTimeout(this.timeoutID),this.timeoutID=null},getRenderedRows:function(){var e=this.collection.current().length?this.getRenderedModels(this.modelView,this.collection.current()):this.blankRow(t._text.no_items);return e},sortRender:function(){this.render()},blankRow:function(e){return'<tr><td colspan="'+this.$("thead tr > *").length+'">'+e+"</td></tr>"},renderRows:function(e){this.$("tbody").html(e||this.getRenderedRows())},renderNav:function(){this.$("#gc-tablenav").html(this.tableNavView.render().el)},render:function(){var e=this.collection.current();return this.renderRows(),this.renderNav(),this.buttonStatus(e.syncEnabled),this.allCheckedStatus(e.allChecked),this}})}},{"./../views/table-nav.js":14,"./../views/table-search.js":15}],14:[function(e,t,s){"use strict";t.exports=function(e,t,s){return e.views.base.extend({template:wp.template("gc-table-nav"),render:function(){var e=this.collection.current();return this.$el.html(this.template({count:e.length,selected:e.checked?e.checked().length:0})),this}})}},{}],15:[function(e,t,s){"use strict";t.exports=function(e){return Backbone.View.extend({el:"#gc-items-search",template:wp.template("gc-table-search"),events:{"keyup #gc-search-input":"filterCollection","search #gc-search-input":"filterCollection"},initialize:function(){this.render()},filterCollection:_.debounce(function(e){this.collection.search(e.target.value)},100),render:function(){return this.$el.html(this.template()),this}})}},{}]},{},[9]);