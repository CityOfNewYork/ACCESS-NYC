/*! GatherContent Plugin - v3.1.13 - 2019-05-22 | http://www.gathercontent.com | Copyright (c) 2019 GatherContent | Licensed GPLv2 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";b.exports=Backbone.Collection.extend({getById:function(a){return this.find(function(b){var c=b.get("id");return c===a||c&&a&&c==a})}})},{}],2:[function(a,b,c){"use strict";b.exports=function(b){var c=null,d="asc",e=b.collections.base.extend({model:b.models.item,totalChecked:0,allChecked:!1,syncEnabled:!1,processing:!1,sortKey:c,sortDirection:d,initialize:function(a,b){this.listenTo(this,"checkAll",this.toggleChecked),this.listenTo(this,"checkSome",this.toggleCheckedIf),this.listenTo(this,"change:checked",this.checkChecked),this.listenTo(this,"sortByColumn",this.sortByColumn),this.totalChecked=this.checked().length,b&&b.reinit&&this.reinit(a)},reinit:function(a){this.totalChecked=this.checked(a).length,this.syncEnabled=this.totalChecked>0,this.allChecked=this.totalChecked>=a.length,this.sortKey=c,this.sortDirection=d,this.sort()},checkChecked:function(a){a.changed.checked?this.totalChecked++:(this.totalChecked===this.length&&(this.allChecked=!1),this.totalChecked--),this.checkAllStatus()},checkAllStatus:function(a){var b=this.syncEnabled;this.syncEnabled=this.totalChecked>0,b!==this.syncEnabled&&this.trigger("enabledChange",this.syncEnabled),this.totalChecked<this.length&&this.trigger("notAllChecked",!1)},toggleCheckedIf:function(a){this.processing=!0,this.stopListening(this,"change:checked",this.checkChecked),this.each(function(b){b.set("checked",Boolean("function"==typeof a?a(b):a))}),this.listenTo(this,"change:checked",this.checkChecked),this.totalChecked=this.checked().length,this.allChecked=this.totalChecked>=this.length,this.checkAllStatus(),this.processing=!1,this.trigger("render")},toggleChecked:function(a){this.allChecked=a,this.toggleCheckedIf(a)},checked:function(a){return a=a||this,a.filter(function(a){return a.get("checked")})},comparator:function(a,b){if(this.sortKey){var c=a.get(this.sortKey),d=b.get(this.sortKey);return"updated_at"===this.sortKey&&(c=c.date||c,d=d.date||d),"status"===this.sortKey&&(c=c.name||c,d=d.name||d),"asc"===this.sortDirection?c>d?-1:d>c?1:0:c<d?-1:d<c?1:0}},sortByColumn:function(a,b){this.sortKey=c=a,this.sortDirection=d=b,this.sort()}});return a("./../collections/search-extension.js")(e)}},{"./../collections/search-extension.js":3}],3:[function(a,b,c){"use strict";b.exports=function(a){return _.extend(a.prototype,{_searchResults:null,search:function(a,b){var c=this._doSearch(a,b);return this.trigger("search",c),c},_doSearch:function(b,c){if(c=!(!c||!c.length)&&c,!this.models.length)return[];var d=this.matcher,e=b?this.filter(function(a){return c=c||(a.searchAttributes||_.keys(a.attributes)),_.some(c,function(c){return d(b,a.get(c))})}):this.models;this.trigger("searchResults",e);var f=new a(e,{reinit:!0});return f.searching={keyword:b,attributes:c},f.getSearchQuery=function(){return this.searching},this._searchResults=f,this.trigger("search",f),f},matcher:function(a,b){if(a&&b)return a=a.toString().toLowerCase(),b=b.toString().toLowerCase(),b.indexOf(a)>=0},getSearchValue:function(){return this.getSearchQuery().keyword},getSearchQuery:function(){return this._searchResults&&this._searchResults.getSearchQuery()||{}},getSearchResults:function(){return this._searchResults},current:function(){return this._searchResults||this}}),a}},{}],4:[function(a,b,c){"use strict";b.exports=function(b){b.models={base:a("./models/base.js")},b.collections={base:a("./collections/base.js")},b.views={base:a("./views/base.js")}}},{"./collections/base.js":1,"./models/base.js":6,"./views/base.js":10}],5:[function(a,b,c){"use strict";b.exports=function(a,b){return b=jQuery.extend({},{action:"gc_sync_items",data:"",percent:0,nonce:"",id:"",stopSync:!0,flush_cache:!1},b),a.models.base.extend({defaults:b,initialize:function(){this.listenTo(this,"send",this.send)},reset:function(){return this.clear().set(this.defaults),this},send:function(a,b,c,d){return c&&this.set("percent",c),jQuery.post(window.ajaxurl,{action:this.get("action"),percent:this.get("percent"),nonce:this.get("nonce"),id:this.get("id"),data:a,flush_cache:this.get("flush_cache")},function(c){return this.trigger("response",c,a),c.success?b(c):d?d(c):void 0}.bind(this)),this}})}},{}],6:[function(a,b,c){"use strict";b.exports=Backbone.Model.extend({sync:function(){return!1}})},{}],7:[function(a,b,c){"use strict";b.exports=function(b,c){return a("./../models/modify-json.js")(b.models.base.extend({defaults:{id:0,item:0,itemName:0,project_id:0,parent_id:0,template_id:0,custom_state_id:0,position:0,name:"",config:"",notes:"",type:"",typeName:"",overdue:!1,archived_by:"",archived_at:"",created_at:null,updated_at:null,status:null,due_dates:null,expanded:!1,checked:!1,post_title:!1,ptLabel:!1},searchAttributes:["itemName","post_title"],_get_item:function(a){return this.get("id")},_get_typeName:function(a){return a||(a=Backbone.Model.prototype.get.call(this,"type")),c._type_names[a]?c._type_names[a]:a}}))}},{"./../models/modify-json.js":8}],8:[function(a,b,c){"use strict";b.exports=function(a){return a.prototype._get=function(a,b){return this["_get_"+b]&&(a=this["_get_"+b](a)),a},a.prototype.get=function(a){return this._get(Backbone.Model.prototype.get.call(this,a),a)},a.prototype.toJSON=function(){return _.mapObject(Backbone.Model.prototype.toJSON.call(this),_.bind(this._get,this))},a}},{}],9:[function(a,b,c){"use strict";window.GatherContent=window.GatherContent||{},function(b,c,d,e,f){e.sync=e.sync||{};var g=e.sync;a("./initiate-objects.js")(g),g.views.tableBase=a("./views/table-base.js")(g,d,e),g.models.item=a("./models/item.js")(g,e),g.collections.items=a("./collections/items.js")(g),g.views.item=a("./views/item.js")(g),g.views.items=a("./views/items.js")(g,d,e),g.init=function(){g.syncView=new g.views.items({el:d(".gc-admin-wrap"),collection:new g.collections.items(e._items)}),d(c.body).on("click","#setting-error-gc-import-last-error .notice-dismiss, #setting-error-gc-import-errors .notice-dismiss",function(){var a=d(this).parents("#setting-error-gc-import-last-error").length>0;d.post(b.ajaxurl,{action:"gc_dismiss_notice",lastError:a?1:0,mapping:e.queryargs.mapping},function(a){e.log("response",a)})}).on("click",".gc-notice-dismiss",function(){d(this).parents(".notice.is-dismissible").find(".notice-dismiss").trigger("click")})},d(g.init)}(window,document,jQuery,window.GatherContent)},{"./collections/items.js":2,"./initiate-objects.js":4,"./models/item.js":7,"./views/item.js":11,"./views/items.js":12,"./views/table-base.js":13}],10:[function(a,b,c){"use strict";b.exports=Backbone.View.extend({toggleExpanded:function(a){this.model.set("expanded",!this.model.get("expanded"))},getRenderedModels:function(a,b){b=b||this.collection;var c=document.createDocumentFragment();return b.each(function(b){var d=new a({model:b}).render();c.appendChild(d.el)}),c},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},close:function(){this.remove(),this.unbind(),this.onClose&&this.onClose()}})},{}],11:[function(a,b,c){"use strict";b.exports=function(a){return a.views.base.extend({template:wp.template("gc-item"),tagName:"tr",className:"gc-item gc-enabled",id:function(){return this.model.get("id")},events:{"change .gc-check-column input":"toggleCheck","click .gc-reveal-items":"toggleExpanded","click .gc-status-column":"toggleCheckAndRender"},initialize:function(){this.listenTo(this.model,"change:checked",this.render)},toggleCheck:function(){this.model.set("checked",!this.model.get("checked"))},toggleCheckAndRender:function(a){this.toggleCheck(),this.render()}})}},{}],12:[function(a,b,c){"use strict";b.exports=function(b,c,d){var e,f=d.percent;return b.views.tableSearch=a("./../views/table-search.js")(b,c,d),b.views.tableNav=a("./../views/table-nav.js")(b,c,d),b.views.tableBase.extend({template:wp.template("gc-items-sync"),progressTemplate:wp.template("gc-items-sync-progress"),modelView:b.views.item,events:{"click .gc-cancel-sync":"clickCancelSync","click .gc-field-th.sortable":"sortRowsByColumn","change .gc-field-th.gc-check-column input":"checkAll","submit form":"submit"},initialize:function(){e=this,b.views.tableBase.prototype.initialize.call(this),this.listenTo(this.ajax,"response",this.ajaxResponse),this.listenTo(this.collection,"enabledChange",this.checkEnableButton),this.listenTo(this.collection,"search",this.initRender),this.initRender()},setupAjax:function(){var c=a("./../models/ajax.js")(b,{checkHits:0,time:500,nonce:d.el("_wpnonce").value,id:d.el("gc-input-mapping_id").value,flush_cache:d.queryargs.flush_cache?1:0});this.ajax=new c({percent:f})},checkEnableButton:function(a){this.buttonStatus(a)},clickCancelSync:function(a){a.preventDefault(),this.cancelSync()},submit:function(a){a.preventDefault(),this.startSync(this.$("form").serialize())},startSync:function(a){this.doSpinner(),this.ajax.reset().set("stopSync",!1),this.renderProgress(100===window.parseInt(f,10)?0:f),this.doAjax(a,f)},cancelSync:function(a){f=null,this.ajax.reset(),this.clearTimeout(),a?this.doAjax("cancel",0,function(){window.location.href=a}):(this.doAjax("cancel",0,function(){}),this.initRender())},doAjax:function(a,b,c){c=c||this.ajaxSuccess.bind(this),this.ajax.send(a,c,b)},ajaxSuccess:function(a){if(!this.ajax.get("stopSync")){f=a.data.percent||1;var b=this.checkHits(),c=this.ajax.get("time");b>25&&c<2e3?(this.clearTimeout(),this.ajax.set("time",2e3)):b>50&&c<5e3&&(this.clearTimeout(),this.ajax.set("time",5e3)),this.setTimeout(this.checkProgress.bind(this)),f>99?(this.renderProgressUpdate(100),window.setTimeout(function(){e.renderProgress(100,!0)},100),this.cancelSync(window.location.href+"&updated=1&flush_cache=1&redirect=1")):this.renderProgressUpdate(f)}},setTimeout:function(a){this.timeoutID=window.setTimeout(a,this.ajax.get("time"))},checkProgress:function(){this.doAjax("check",f)},checkHits:function(){return window.parseInt(this.ajax.get("checkHits"),10)},ajaxResponse:function(a,b){if(d.log("warn","hits/interval/response: "+this.checkHits()+"/"+this.ajax.get("time")+"/",a.success?a.data:a),"check"===b?this.ajax.set("checkHits",this.checkHits()+1):a.data&&this.ajax.set("checkHits",0),!a.success&&(this.renderProgressUpdate(0),this.cancelSync(),a.data))return void(a.data.url?(window.alert(a.data.message),window.location.href=a.data.url):window.alert(a.data))},renderProgressUpdate:function(a){this.$(".gc-progress-bar-partial").css({width:a+"%"}).find("span").text(a+"%")},renderProgress:function(a,b){this.$el.addClass("gc-sync-progress"),this.buttonStatus(!1),this.$("#sync-tabs").html(this.progressTemplate({percent:null===a?0:a,loader:!0===b}))},renderRows:function(a){this.$("#sync-tabs tbody").html(a||this.getRenderedRows())},sortRender:function(){this.initRender()},initRender:function(){var a=this.collection.current();f>0&&f<100?this.startSync("check"):(this.$("#sync-tabs").html(this.template({checked:a.allChecked,sortKey:a.sortKey,sortDirection:a.sortDirection})),this.render())},render:function(){return this.$el.removeClass("gc-sync-progress"),b.views.tableBase.prototype.render.call(this)}})}},{"./../models/ajax.js":5,"./../views/table-nav.js":14,"./../views/table-search.js":15}],13:[function(a,b,c){"use strict";b.exports=function(b,c,d){return b.views.tableSearch=a("./../views/table-search.js")(b,c,d),b.views.tableNav=a("./../views/table-nav.js")(b,c,d),b.views.base.extend({timeoutID:null,ajax:null,tableNavView:null,searchView:null,modelView:null,timeoutTime:1e3,events:{"click .gc-field-th.sortable":"sortRowsByColumn","change .gc-field-th.gc-check-column input":"checkAll"},initialize:function(){this.setupAjax(),this.listenTo(this.collection,"render",this.render),this.listenTo(this.collection,"notAllChecked",this.allCheckedStatus),this.listenTo(this.collection,"change:checked",this.renderNav),this.listenTo(this,"render",this.render),this.tableNavView=new b.views.tableNav({collection:this.collection}),this.searchView=new b.views.tableSearch({collection:this.collection})},setupAjax:function(){},sortRowsByColumn:function(a){a.preventDefault();var b=this.collection.current(),d=c(a.currentTarget),e=d.find("a").data("id"),f=!1;d.hasClass("asc")&&(f="desc"),d.hasClass("desc")&&(f="asc"),f||(f=b.sortDirection),"asc"===f?d.addClass("desc").removeClass("asc"):d.addClass("asc").removeClass("desc"),b.trigger("sortByColumn",e,f),this.sortRender()},buttonStatus:function(a){this.$(".button-primary").prop("disabled",!a)},allCheckedStatus:function(){this.$(".gc-field-th.gc-check-column input").prop("checked",this.collection.allChecked)},checkAll:function(a){this.collection.trigger("checkAll",c(a.target).is(":checked"))},doSpinner:function(){var a=this.blankRow('<span class="gc-loader spinner is-active"></span>');this.renderRows(a)},setTimeout:function(a){this.timeoutID=window.setTimeout(a,this.timeoutTime)},clearTimeout:function(){window.clearTimeout(this.timeoutID),this.timeoutID=null},getRenderedRows:function(){return this.collection.current().length?this.getRenderedModels(this.modelView,this.collection.current()):this.blankRow(d._text.no_items)},sortRender:function(){this.render()},blankRow:function(a){return'<tr><td colspan="'+this.$("thead tr > *").length+'">'+a+"</td></tr>"},renderRows:function(a){this.$("tbody").html(a||this.getRenderedRows())},renderNav:function(){this.$("#gc-tablenav").html(this.tableNavView.render().el)},render:function(){var a=this.collection.current();return this.renderRows(),this.renderNav(),this.buttonStatus(a.syncEnabled),this.allCheckedStatus(a.allChecked),this}})}},{"./../views/table-nav.js":14,"./../views/table-search.js":15}],14:[function(a,b,c){"use strict";b.exports=function(a,b,c){return a.views.base.extend({template:wp.template("gc-table-nav"),render:function(){var a=this.collection.current();return this.$el.html(this.template({count:a.length,selected:a.checked?a.checked().length:0})),this}})}},{}],15:[function(a,b,c){"use strict";b.exports=function(a){return Backbone.View.extend({el:"#gc-items-search",template:wp.template("gc-table-search"),events:{"keyup #gc-search-input":"filterCollection","search #gc-search-input":"filterCollection"},initialize:function(){this.render()},filterCollection:_.debounce(function(a){this.collection.search(a.target.value)},100),render:function(){return this.$el.html(this.template()),this}})}},{}]},{},[9]);