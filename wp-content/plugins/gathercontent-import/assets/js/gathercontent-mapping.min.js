/*! GatherContent Plugin - v3.1.5 - 2017-09-05 | http://www.gathercontent.com | Copyright (c) 2017 GatherContent | Licensed GPLv2 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";b.exports=Backbone.Collection.extend({getById:function(a){return this.find(function(b){var c=b.get("id");return c===a||c&&a&&c==a})}})},{}],2:[function(a,b,c){"use strict";b.exports=function(a){return a.collections.base.extend({model:a.models.tabRow,initialize:function(a,b){this.tab=b.tab}})}},{}],3:[function(a,b,c){"use strict";b.exports=function(a){return a.collections.base.extend({model:a.models.tab})}},{}],4:[function(a,b,c){"use strict";b.exports=function(b){b.models={base:a("./models/base.js")},b.collections={base:a("./collections/base.js")},b.views={base:a("./views/base.js")}}},{"./collections/base.js":1,"./models/base.js":6,"./views/base.js":10}],5:[function(a,b,c){"use strict";window.GatherContent=window.GatherContent||{},function(b,c,d,e,f){e.mapping=e.mapping||{};var g=e.mapping;a("./initiate-objects.js")(g),g.views.statusSelect2=a("./views/status-select2.js")(g),g.models.tabRow=a("./models/tab-row.js")(g,e),g.collections.tabRows=a("./collections/tab-rows.js")(g),g.views.tabRow=a("./views/tab-row.js")(g,e._meta_keys),g.models.tab=a("./models/tab.js")(g,e._table_headings),g.collections.tabs=a("./collections/tabs.js")(g),g.views.tab=a("./views/tab.js")(g),g.views.tabLink=a("./views/tab-link.js")(g),g.views.defaultTab=a("./views/default-tab.js")(g,e._table_headings),g.views.tabs=a("./views/tabs.js")(g,d,e),g.init=function(){g.mappingView=new g.views.tabs({collection:new g.collections.tabs(e._tabs)})},d(g.init)}(window,document,jQuery,window.GatherContent)},{"./collections/tab-rows.js":2,"./collections/tabs.js":3,"./initiate-objects.js":4,"./models/tab-row.js":8,"./models/tab.js":9,"./views/default-tab.js":11,"./views/status-select2.js":12,"./views/tab-link.js":13,"./views/tab-row.js":14,"./views/tab.js":15,"./views/tabs.js":16}],6:[function(a,b,c){"use strict";b.exports=Backbone.Model.extend({sync:function(){return!1}})},{}],7:[function(a,b,c){"use strict";b.exports=function(a){return a.prototype._get=function(a,b){return this["_get_"+b]&&(a=this["_get_"+b](a)),a},a.prototype.get=function(a){return this._get(Backbone.Model.prototype.get.call(this,a),a)},a.prototype.toJSON=function(){return _.mapObject(Backbone.Model.prototype.toJSON.call(this),_.bind(this._get,this))},a}},{}],8:[function(a,b,c){"use strict";b.exports=function(b,c){return a("./../models/modify-json.js")(b.models.base.extend({defaults:{id:"",label:"",name:"",field_type:"",type:"",typeName:"",post_type:"post",field_value:!1,expanded:!1,required:!1,value:"",microcopy:"",limit_type:"",limit:0,plain_text:!1},_get_post_type:function(a){return b.mappingView?b.mappingView.defaultTab.get("post_type"):a},_get_type:function(a){return"text"===a&&(a=this.get("plain_text")?"text_plain":"text_rich"),a},_get_typeName:function(a){return a=this.get("type"),c._type_names[a]?c._type_names[a]:a}}))}},{"./../models/modify-json.js":7}],9:[function(a,b,c){"use strict";b.exports=function(a,b){return a.models.base.extend({defaults:{id:"",label:"",hidden:!1,navClasses:"",rows:[],table_id:"",col_headings:b["default"]},initialize:function(){this.rows=new a.collections.tabRows(this.get("rows"),{tab:this}),this.listenTo(this.rows,"change",this.triggerRowChange)},triggerRowChange:function(a){this.trigger("rowChange",a)}})}},{}],10:[function(a,b,c){"use strict";b.exports=Backbone.View.extend({toggleExpanded:function(a){this.model.set("expanded",!this.model.get("expanded"))},getRenderedModels:function(a,b){b=b||this.collection;var c=document.createDocumentFragment();return b.each(function(b){var d=new a({model:b}).render();c.appendChild(d.el)}),c},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},close:function(){this.remove(),this.unbind(),this.onClose&&this.onClose()}})},{}],11:[function(a,b,c){"use strict";b.exports=function(a,b){return a.views.tab.extend({events:{"change select":"changeDefault","click .gc-reveal-items":"toggleExpanded"},defaultTabTemplate:wp.template("gc-mapping-defaults-tab"),statusMappingsTemplate:wp.template("gc-mapping-defaults-tab-status-mappings"),changeDefault:function(a){var b=jQuery(a.target),c=b.val(),d=b.data("column");if(c){if(b.data("select2")){var e=b.select2("data")[0];e.text&&this.model.set("select2:"+d+":"+c,e.text)}this.model.set(d,c)}},render:function(){var a=this.model.toJSON();return this.$el.html(this.htmlWrap(a)),this.$el.find("tbody").first().html(this.defaultTabTemplate(a)),this.$el.find("#gc-status-mappings tbody").html(this.statusMappingsTemplate(a)),this.renderSelect2(),this},htmlWrap:function(a){var c=this.template(a);return this.model.get("initial")||(a.table_id="gc-status-mappings",delete a.label,a.col_headings=b.status,c+="<br>",c+=this.template(a)),c},select2Args:function(b){var c={};switch(b.column){case"gc_status":c=a.views.statusSelect2.prototype.select2Args.call(this,b);break;case"post_author":c.width="250px",c.minimumInputLength=2,c.ajax={url:b.url,data:function(a){return{q:a.term,column:b.column}},delay:250,cache:!0}}return c}})}},{}],12:[function(a,b,c){"use strict";b.exports=function(a){var b;return a.views.base.extend({select2ItemTemplate:wp.template("gc-select2-item"),width:"250px",renderSelect2:function(a){var c=a?a.find(".gc-select2"):this.$(".gc-select2");return b=this,c.each(function(){var a=jQuery(this),c=a.data();a.select2(b.select2Args(c));var d=a.data("select2");d.$results.addClass("select2-"+c.column),d.$container.addClass("select2-"+c.column)}),this},select2Args:function(a){var c={width:b.width};return c.templateResult=function(a,c){var d=jQuery.extend(a,jQuery(a.element).data());return d.description=!1===c?!1:d.description||"",jQuery(b.select2ItemTemplate(a))}.bind(b),c.templateSelection=function(a){return c.templateResult(a,!1)},c}})}},{}],13:[function(a,b,c){"use strict";b.exports=function(a){return a.views.base.extend({tagName:"a",id:function(){return"tabtrigger-"+this.model.get("id")},className:function(){return"nav-tab "+(this.model.get("hidden")?"":"nav-tab-active")+" "+this.model.get("navClasses")},render:function(){return this.$el.text(this.model.get("label")).attr("href","#"+this.model.get("id")),this}})}},{}],14:[function(a,b,c){"use strict";b.exports=function(a,b){return a.views.base.extend({tagName:"tr",template:wp.template("gc-mapping-tab-row"),events:{"change .wp-type-select":"changeType","change .wp-type-value-select":"changeValue","click  .gc-reveal-items":"toggleExpanded"},initialize:function(){this.listenTo(this.model,"change:field_type",this.render),this.metaKeys=new(a.collections.base.extend({model:a.models.base.extend({defaults:{value:""}}),getByValue:function(a){return this.find(function(b){return b.get("value")===a})}}))(b)},changeType:function(a){this.model.set("field_type",jQuery(a.target).val())},changeValue:function(a){var b=jQuery(a.target).val();""===b?(this.model.set("field_value",""),this.model.set("field_type","")):this.model.set("field_value",b)},render:function(){var a=this.model.get("field_value");a&&!this.metaKeys.getByValue(a)&&this.metaKeys.add({value:a});var b=this.model.toJSON();return b.metaKeys=this.metaKeys.toJSON(),this.$el.html(this.template(b)),this.$(".gc-select2").each(function(){var a=jQuery(this),b={width:"250px"};a.hasClass("gc-select2-add-new")&&(b.tags=!0),a.select2(b)}),this}})}},{}],15:[function(a,b,c){"use strict";b.exports=function(a){return a.views.statusSelect2.extend({template:wp.template("gc-tab-wrapper"),tagName:"fieldset",id:function(){return this.model.get("id")},className:function(){return"gc-template-tab "+(this.model.get("hidden")?"hidden":"")},render:function(){this.$el.html(this.template(this.model.toJSON()));var b=this.getRenderedModels(a.views.tabRow,this.model.rows);return this.$el.find("tbody").html(b),this}})}},{}],16:[function(a,b,c){"use strict";b.exports=function(a,b,c){return a.views.base.extend({initial:c._initial,el:"#mapping-tabs",template:wp.template("gc-tabs-wrapper"),events:{"click .nav-tab":"tabClick","click .nav-tab-link":"triggerClick"},initialize:function(){this.listenTo(this.collection,"render",this.render),this.listenTo(this,"render",this.render),this.listenTo(this,"saveEnabled",this.enableSave),this.listenTo(this,"saveDisabled",this.disableSave),this.initial&&this.listenTo(this.collection,"change:post_type",this.initMapping),this.defaultTab=this.collection.getById("mapping-defaults"),this.render(),!this.initial&&c._pointers.refresh_connection&&window.setTimeout(function(){this.pointer(b(".submit .gc-refresh-connection"),"refresh_connection",{position:{edge:"top"}}),b(".gc-wp-pointer.refresh_connection").css({"margin-left":"-41px"})}.bind(this),500)},initMapping:function(){this.initial=!1,this.stopListening(this.collection,"change:post_type",this.initMapping),this.listenTo(this.collection,"rowChange",this.triggerSaveEnabled),this.defaultTab.set("initial",this.initial),this.render(),c._pointers.select_tab_how_to&&(this.pointer(".gc-nav-tab-wrapper-bb","select_tab_how_to"),this.pointer("#gc-status-mappings","map_status_how_to"))},triggerSaveEnabled:function(a){a.changed.field_value&&(this.trigger("saveEnabled"),this.stopListening(this.collection,"rowChange"))},triggerClick:function(a){a.preventDefault(),this.$('.nav-tab[href="'+b(a.target).attr("href")+'"]').trigger("click")},tabClick:function(a){a.preventDefault(),this.setTab(b(a.target).attr("href").substring(1)),this.render()},setTab:function(a){this.$el.attr("class",a),this.collection.invoke("set",{hidden:!0}),this.collection.getById(a).set("hidden",!1)},render:function(){return this.$(".gc-select2").each(function(){b(this).select2("destroy")}),this.$el.html(this.template()),this.renderNav(),this.renderTabs(),this.initial&&this.renderInitial(),this},renderNav:function(){var b;this.initial?(this.setTab(this.defaultTab.get("id")),b=new a.views.tabLink({model:this.defaultTab}).render().el):b=this.getRenderedModels(a.views.tabLink),this.$el.find(".nav-tab-wrapper").append(b)},renderTabs:function(){var b=document.createDocumentFragment();if(this.initial){this.defaultTab.set("initial",this.initial);var c=new a.views.defaultTab({model:this.defaultTab});b.appendChild(c.render().el)}else this.collection.each(function(c){var d="mapping-defaults"===c.get("id")?"defaultTab":"tab",e=new a.views[d]({model:c});b.appendChild(e.render().el)});this.$el.find(".gc-template-tab-group").append(b)},renderInitial:function(){this.pointer('[data-column="post_type"]',"select_type",{dismissable:!1,position:{edge:"bottom",align:"left"}}),this.trigger("saveDisabled")},enableSave:function(){b(".submit .button-primary").prop("disabled",!1)},disableSave:function(){b(".submit .button-primary").prop("disabled",!0)},pointer:function(a,d,e){e=e||{};var f={content:c._pointers[d],pointerClass:"wp-pointer gc-wp-pointer "+d};return!1!==e.dismissable&&(f.close=function(){b.post(window.ajaxurl,{pointer:"gc_"+d,action:"dismiss-wp-pointer"})}),e.position&&(f.position=e.position),a=a instanceof jQuery?a:this.$(a),a.pointer(f).pointer("open")}})}},{}]},{},[5]);