"use strict";(self.webpackChunkgravitysmtp=self.webpackChunkgravitysmtp||[]).push([[1114],{66457:function(t,e,n){n.r(e),n.d(e,{default:function(){return z}});var i=n(71860),r=n(90455),o=n(8140),a=n(88856),s=n(78564),c=n.n(s),l=n(27122),u=n.n(l),p=n(97867),d=n(60177),v=n(21713),g=n(46716),f=n(30242),m=n(80509),b=n(48959),y=n(84860),h=n(55899),_=n(28099),S=n(83707),k=n(75149),A=n(93313),O=n(53015);function w(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.fromEntries(Object.entries(t).filter((function(t){var n=(0,o.A)(t,1)[0];return!(0,O.A)("".concat(e,"_").concat(n))})))}var j=n(55809),P=n(59092);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){(0,a.A)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C=p.React.forwardRef,R=p.React.useEffect,I=p.React.useState,D=p.React.useRef,E=C((function(t,e){var n,a,s,l,O,x,C,E=t.customAttributes,z=void 0===E?{}:E,B=t.customClasses,L=void 0===B?[]:B,N=t.common,F=void 0===N?{}:N,H=t.data,M=void 0===H?{}:H,J=t.i18n,U=void 0===J?{}:J,X=(null==U?void 0:U.integrations)||{},W=X.integration_settings_apply,q=X.integration_settings_cancel,G=X.integration_settings_error,K=(null==F?void 0:F.i18n)||{},Q=K.debug_messages,V=void 0===Q?{}:Q,Y=V.saving_integration_settings,Z=void 0===Y?"":Y,$=V.saving_integration_settings_error,tt=void 0===$?"":$,et=K.snackbar_api_save_success,nt=T({className:(0,p.classnames)({"gravitysmtp-integration-settings":!0},L)},z),it=(0,P.default)((function(t){return t.activeIntegrationSettings})),rt=(0,P.default)((function(t){return t.integrationSettingsFormData})),ot=(0,P.default)((function(t){return t.integrations})),at=(0,P.default)((function(t){return t.integrationSettingsDialogOpen})),st=I(!1),ct=(0,o.A)(st,2),lt=ct[0],ut=ct[1],pt=D(null),dt=(0,P.default)((function(t){return t.setIntegrationSettingsDialogOpen})),vt=(0,P.default)((function(t){return t.updateIntegrationStatus})),gt=(0,P.default)((function(t){return t.setIntegrationSettingsFormData})),ft=function(t,e){return gt(it,t,e)},mt=(0,v.uN)(M,"id",it),bt=(null==mt||null===(n=mt.settings)||void 0===n?void 0:n.fields)||[],yt=(null==F||null===(a=F.endpoints)||void 0===a||null===(a=a.save_connector_settings)||void 0===a?void 0:a.action)||"",ht=(null==F||null===(s=F.endpoints)||void 0===s||null===(s=s.save_connector_settings)||void 0===s?void 0:s.nonce)||"",_t=(0,y.dh)(),St=(null==mt||null===(l=mt.settings)||void 0===l?void 0:l.hide_save)||!1,kt=(null===(O=rt[it])||void 0===O?void 0:O.from_email)||"";R((function(){kt||ft("force_from_email",!1)}),[kt,ft]);var At=function(){var t=(0,r.A)(c().mark((function t(){var e,n,i,r,o,a,s,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null!=pt&&pt.current&&(e=pt.current.offsetWidth,pt.current.style.width="".concat(e,"px")),ut(!0),n={action:yt,security:ht,settings:w(rt[it],it),connector_type:it},t.next=5,(0,S.A)((0,v.nv)(Z,it,JSON.stringify((0,A.A)(["api_key","server_api_token","password","security"],n))),"info");case 5:return t.prev=5,t.next=8,(0,d.bE)({endpoint:u(),body:n});case 8:null!=(r=t.sent)&&null!==(i=r.data)&&void 0!==i&&i.success?(o=T({configured:!0},""===(0,k.A)(ot)&&{is_primary:!0}),_t(et),vt(it,o),(0,g.saveActivationState)(it,yt,ht,o),setTimeout((function(){dt(!1)}),1e3)):(l=(0,v.Fh)(null==r||null===(a=r.error)||void 0===a||null===(a=a.detail)||void 0===a?void 0:a.data)?JSON.parse(null==r||null===(s=r.error)||void 0===s||null===(s=s.detail)||void 0===s?void 0:s.data):"",_t((null==l?void 0:l.data)||G,"error")),t.next=17;break;case 12:return t.prev=12,t.t0=t.catch(5),t.next=16,(0,S.A)((0,v.nv)(tt,it,JSON.stringify(t.t0)),"error");case 16:case 17:ut(!1),null!=pt&&pt.current&&(pt.current.style.width="");case 19:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(){return t.apply(this,arguments)}}(),Ot={closeButtonType:"simplified",customCloseButtonLabelAttributes:{className:(0,p.classnames)({"gform-button__icon":!0,"gravitysmtp-admin-icon":!0,"gravitysmtp-admin-icon--x":!0})},customMaskClasses:["gravitysmtp-integration-settings__mask"],description:null==mt||null===(x=mt.settings)||void 0===x?void 0:x.description,isOpen:at,maskTheme:"light",maxHeight:"90vh",mode:"modal",onClose:function(){if(new URLSearchParams(window.location.search).has("integration")){var t=new URL(window.location.href),e=new URLSearchParams(t.search);e.delete("integration"),t.search=e.toString(),window.history.pushState({path:t.toString()},"",t.toString())}dt(!1)},padContent:!1,position:"absolute",simplebar:!0,theme:"cosmos",title:null==mt||null===(C=mt.settings)||void 0===C?void 0:C.title,titleSize:"md",titleTagName:"h3",version:2},wt=(0,p.classnames)({"gravitysmtp-integration-settings__save":!0,"gravitysmtp-integration-settings__save--saving":lt}),jt=(0,_.A)(bt,{activeIntegrationSettings:it,integrationSettingsFormData:rt,saveConnectorSettings:At,savingSettings:lt,Svgs:j,i18n:null==F?void 0:F.i18n,addSnackBarMessage:_t});return p.React.createElement("div",(0,i.A)({},nt,{ref:e}),p.React.createElement(b.A,Ot,p.React.createElement("form",{id:it},p.React.createElement(h.A,{id:it,fields:jt,setFieldData:ft})),p.React.createElement(f.A,{customClasses:["gravitysmtp-integration-settings__actions"],display:"flex",spacing:[8,0,0,0]},p.React.createElement(m.A,{label:q,onClick:function(){return dt(!1)},size:"size-height-m",type:"white"}),!St&&p.React.createElement(m.A,{active:lt,activeType:"loader",customClasses:wt,icon:"save-disk",iconPosition:"leading",iconPrefix:"gravitysmtp-admin-icon",label:W,onClick:At,ref:pt,spacing:[0,0,0,3],size:"size-height-m"}))))}));E.propTypes={customAttributes:p.PropTypes.object,customClasses:p.PropTypes.oneOfType([p.PropTypes.string,p.PropTypes.array,p.PropTypes.object]),common:p.PropTypes.object,data:p.PropTypes.object,i18n:p.PropTypes.object},E.displayName="IntegrationSettings";var z=E},28099:function(t,e,n){var i=n(90455),r=n(88856),o=n(78564),a=n.n(o),s=n(97867),c=n(63662),l=n(12094),u=n(87029),p=n(25787),d=n(66598),v=n(21713),g=n(16675),f=n(27764);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){(0,r.A)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y=function(t,e){return t.map((function(t){var n,i;if(null==t||null===(n=t.props)||void 0===n||!n.name)return t;var r="".concat(e,"_").concat(t.props.name),o=(null==t||null===(i=t.props)||void 0===i?void 0:i.labelAttributes)||{};return b(b({},t),{},{props:b(b({},t.props),{},{labelAttributes:b(b({},o),(0,f.A)(r))})})}))},h=function(t,e){var n=e.integrationSettingsFormData[e.activeIntegrationSettings],i=null==n?void 0:n.from_email;return t.map((function(t){var e;if("force_from_email"!==(null==t||null===(e=t.props)||void 0===e?void 0:e.name))return t;var r=b(b({},t),{},{props:b(b({},t.props),{},{externalControl:!0,externalChecked:null==n?void 0:n.force_from_email})});return i&&/\S+@\S+\.\S+/.test(i)||(r.props.disabled=!0),r}))},_=function(t,e){return t.map((function(t,n){var i;if(0!==n||"Alert"!==(null==t?void 0:t.component)||"google-alias-notice"!==(null==t||null===(i=t.props)||void 0===i?void 0:i.id))return t;var r=S((null==t?void 0:t.fields)||[],e);return b(b({},t),{},{fields:r})}))},S=function(t,e){var n=e.integrationSettingsFormData[e.activeIntegrationSettings],r=t.map((function(t){if(!["BrandedButton","BrandedLink","CopyInput","LinkedHelpTextInput","LinkedText"].includes(t.component)||!t.external)return t;var r,o=e.i18n.snackbar_url_copied,f=void 0===o?"":o,m=e.Svgs[t.props.Svg],y=null,h={};switch(t.component){case"BrandedButton":y=c.A,h=b(b({},t.props),{},{disabled:!(null!=n&&n.client_id&&null!=n&&n.client_secret)||e.savingSettings,onClick:(r=(0,i.A)(a().mark((function t(i){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.preventDefault(),t.next=3,e.saveConnectorSettings();case 3:window.location.href="".concat(n.oauth_url,"?client_id=").concat(n.client_id).concat(n.oauth_params);case 4:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)}),Svg:s.React.createElement(m,null)});break;case"BrandedLink":y=l.A,h=b(b({},t.props),{},{href:"wizard"===e.context?t.wizardHref:t.props.href,Svg:s.React.createElement(m,null)});break;case"CopyInput":y=p.A,h=b(b({},t.props),{},{actionButtonAttributes:b(b({},t.props.actionButtonAttributes),{},{onClick:function(t,n){e.addSnackBarMessage(f),(0,v.Ns)(n)}})});break;case"LinkedHelpTextInput":y=p.A,h=b(b({},t.props),{},{helpTextAttributes:b(b({},t.props.helpTextAttributes),{},{content:s.React.createElement(g.Xx,{openingSymbol:"{{",closingSymbol:"}}",text:t.props.helpTextAttributes.content,tokens:t.links.map((function(t){return{component:u.A,key:t.key,props:t.props}}))})})});break;case"LinkedText":y=d.A,h=b(b({},t.props),{},{content:s.React.createElement(g.Xx,{openingSymbol:"{{",closingSymbol:"}}",text:t.props.content,tokens:t.links.map((function(t){return{component:u.A,key:t.key,props:t.props}}))})})}return b(b({},t),{},{component:y,props:h})}));return r},k=function(t,e){var n=e.integrationSettingsFormData[e.activeIntegrationSettings];return t.map((function(t){var e;if("Input"!==t.component||!["username","password"].includes(null==t||null===(e=t.props)||void 0===e?void 0:e.name))return t;var i=b(b({},t.props),{},{disabled:!n.auth});return b(b({},t),{},{props:i})}))},A=function(t){return t.map((function(t){var e,n=((null==t||null===(e=t.props)||void 0===e||null===(e=e.labelAttributes)||void 0===e?void 0:e.label)||"").toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""),i=b(b({},t.props),{},{customAttributes:b(b({},t.props.customAttributes),{},{"data-test-id":"form-field-".concat(n)})});return b(b({},t),{},{props:i})}))};e.A=function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=h(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t),n=A(e),i=y(n,t.activeIntegrationSettings);if(!["microsoft","google","generic","amazon","zoho"].includes(t.activeIntegrationSettings))return i;var r=i;return"google"===t.activeIntegrationSettings&&(r=_(r,t)),["microsoft","google","amazon","zoho"].includes(t.activeIntegrationSettings)?r=S(r,t):"generic"===t.activeIntegrationSettings&&(r=k(r,t)),r}},53015:function(t,e,n){var i,r=n(40450),o=n.n(r),a=(null===(i=(0,n(21713).zj)(o(),"gravitysmtp_admin_config"))||void 0===i?void 0:i.common)||{};e.A=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(null==a||null===(t=a.data)||void 0===t||null===(t=t.locked_settings)||void 0===t?void 0:t.includes(e))||n}},27764:function(t,e,n){var i,r=n(40450),o=n.n(r),a=(null===(i=(0,n(21713).zj)(o(),"gravitysmtp_admin_config"))||void 0===i?void 0:i.common)||{};e.A=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{iconPrefix:"gravitysmtp-admin-icon",locked:(null==a||null===(t=a.data)||void 0===t||null===(t=t.locked_settings)||void 0===t?void 0:t.includes(n))||i,lockedMessage:r||(null==a||null===(e=a.i18n)||void 0===e?void 0:e.setting_locked)||""}}}}]);