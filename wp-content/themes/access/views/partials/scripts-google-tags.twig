<script type="text/javascript" id="data-layer">
  window.dataLayer = window.dataLayer || [];
</script>

{% if function('get_env', 'GOOGLE_OPTIMIZE_ID') != '' %}
<style>.async-hide {opacity: 0 !important}</style>
<script type="text/javascript" id="google-async-hide">
  (function(a, s, y, n, c, h, i, d, e) {
    s.className += ' ' + y; h.start = 1 * new Date;
    h.end = i = function() {s.className = s.className.replace(RegExp(' ?' + y), '');};
    (a[n] = a[n] || []).hide = h; setTimeout(function() {i(); h.end = null}, c); h.timeout = c;
  })(window, document.documentElement, 'async-hide', 'dataLayer', 4000, {"{{ function('get_env', 'GOOGLE_OPTIMIZE_ID') }}": true});
</script>
{% endif %}

{% if function('get_env', 'GOOGLE_ANALYTICS') != '' %}
<script async type="text/javascript" src='https://www.googletagmanager.com/gtag/js?id={{ function('get_env', 'GOOGLE_ANALYTICS') }}'></script>
<script type="text/javascript" id="google-gtag">
  function gtag() {dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', "{{ function('get_env', 'GOOGLE_ANALYTICS') }}"{% if function('get_env', 'GOOGLE_OPTIMIZE_ID') != '' %}, {'optimize_id': "{{ function('get_env', 'GOOGLE_OPTIMIZE_ID') }}"}{% endif %});
</script>
{% endif  %}
