
{% set shownHowToApply = false %}

{% set helpMethods = [
  'get_help_online',
  'get_help_by_email',
  'get_help_by_calling_311',
  'get_help_by_calling_other_than_311',
  'get_help_in_person'
] %}

{% set shownSections = post.get_field('show_sections') %}

<article class="p-bottom" data-code="{{ post.program_code }}">

  <div class="p-2 bg-grey-lightest d-flex">

    <div>
      {% include 'partials/category-icon.twig' with {width: '80px', height: '80px', target: '_blank'} %}
    </div>

    <div class="w-100 p-horizontal">

      <a href="{{ post.get_permalink }}" target="_blank">
        <h3 class="program-card-title type-h4">
          {{ post.plain_language_program_name }}
        </h3>
      </a>
      {% if not short_post %}
      <p class="program-card-subtitle type-small">{{ post.program_name }} {% if post.program_acronym != '' %}({{ post.program_acronym }}){% endif %}</p>
      {% endif %}

      {{ post.brief_excerpt }}

    </div>

    <div class="d-flex fd-column jc-space-between hide-for-print">

      <div style="width:205px" class="p-bottom">
        <div id="remove-{{ post.program_code }}">
          <a class="btn btn-primary btn-small d-block" href="#confirm-{{ post.program_code }}"
            data-js="simple-toggle"
            data-hide="#remove-{{ post.program_code }}">
            {{ __('Remove Program', 'accessnyc-screener') }}
          </a>
        </div>
        <div id="confirm-{{ post.program_code }}" class="hidden" aria-hidden="true">
          <p class="type-small ta-center bottom-4">{{ __('Are you sure?', 'accessnyc-screener') }}</p>
          <div class="d-flex">
            <a class="f-1 btn btn-primary btn-small"
              data-js="remove-program"
              data-remove-code="{{ post.program_code }}">{{ __('Remove', 'accessnyc-screener') }}</a>
            <a class="f-1 btn btn-secondary btn-small m-left" href="#remove-{{ post.program_code }}"
              data-js="simple-toggle"
              data-hide="#confirm-{{ post.program_code }}">{{ __('Keep', 'accessnyc-screener') }}</a>
          </div>
        </div>
      </div>

      <div>
        <a class="btn-toggle btn" href="#program-detail-{{ post.program_code }}"
          data-js="simple-toggle">
          {{ __('Learn More', 'accessnyc-screener') }}
        </a>
      </div>

    </div>

  </div>

  <div class="p-2 d-flex hidden active-for-print" id="program-detail-{{ post.program_code }}">

    <div>
      <div style="width:80px;height:80px;">&nbsp;</div>
    </div>

    <div class="w-100 p-horizontal">

      {% for section in shownSections %}

      {% if section.value == 'how-it-works' %}
      <div class="m-bottom-2">
        <h3>{{__('How it Works', 'accessnyc-program-detail')}}</h3>
        {{ post.get_field('program_description') }}
      </div>
      {% endif %}

      {% endfor %}

      {% if post.heads_up | length %}
      <div class="program-detail-heads-up program-detail-heads-up--{{ post.program_code }} m-bottom-2">
        <h3>{{__('Heads Up', 'accessnyc-program-detail')}}</h3>
        {{ post.get_field('heads_up') }}
        {% for section in shownSections %}{% if section.value == 'what-you-need-to-include' %}
        <p class="hide-for-print">
          <a class="btn btn-secondary btn-next" href="{{ post.get_permalink }}?step=what-you-need-to-include" target="_blank">See a full list of required documents</a>
        </p>
        {% endif %}{% endfor %}
      </div>
      {% endif %}

      {% for section in post.get_field('show_sections') %}

      {% if section.value == 'how-to-apply' %}
      <div class="m-bottom-2">

        <h3>{{__('How to apply', 'accessnyc-program-detail')}}</h3>

        {% if post.how_to_apply_or_enroll_online != '' %}

        <article class="c-accordion">
          <header class="c-accordion__header">
            <p>{{__('Apply online', 'accessnyc-program-detail')}}</p>
            <a class="c-accordion__toggle" data-js="simple-toggle" href="#apply-online-{{ post.program_code }}">
              <span data-css-text="+ {{__('show this list', 'accessnyc-program-detail')}}"
                    data-css-active-text="- {{__('hide this list', 'accessnyc-program-detail')}}">
            </a>
          </header>
          <div class="c-accordion__body hidden hidden-by-overflow animated active-for-print" id="apply-online-{{ post.program_code }}">
            <div class="c-accordion__padding">
              {{ post.get_field('how_to_apply_or_enroll_online') }}
              {% if post.apply_online_call_to_action != '' %}
              <p class="hide-for-print">
                <a class="btn btn-secondary btn-next" href="{{ post.url_of_online_application }}" target="_blank">{{ post.apply_online_call_to_action }}</a>
              </p>
              {% endif %}
            </div>
          </div>
        </article>

        {% endif %}

        {% if post.how_to_apply_or_enroll_by_mail != '' %}

        <article class="c-accordion">
          <header class="c-accordion__header">
            <p>{{__('Apply by mail', 'accessnyc-program-detail')}}</p>
            <a class="c-accordion__toggle hide-for-print" data-js="simple-toggle" href="#apply-by-mail-{{ post.program_code }}">
              <span data-css-text="+ {{__('show this list', 'accessnyc-program-detail')}}"
                    data-css-active-text="- {{__('hide this list', 'accessnyc-program-detail')}}">
            </a>
          </header>
          <div class="c-accordion__body hidden hidden-by-overflow animated active-for-print" id="apply-by-mail-{{ post.program_code }}">
            <div class="c-accordion__padding">
              {{ post.get_field('how_to_apply_or_enroll_by_mail') }}
              {% if post.apply_by_mail_call_to_action != '' %}
              <p class="hide-for-print">
                <a class="btn btn-secondary btn-next" href="{% if post.url_of_pdf_application_forms != '' %}{{ post.url_of_pdf_application_forms }}{% else %}{{ post.application_forms_pdfs }}{% endif %}" target="_blank">{{ post.apply_by_mail_call_to_action }}</a>
              </p>
              {% endif %}
            </div>
          </div>
        </article>

        {% endif %}

        {% if post.how_to_apply_or_enroll_by_phone != '' %}

        <article class="c-accordion">
          <header class="c-accordion__header">
            <p>{{__('Apply by phone', 'accessnyc-program-detail')}}</p>
            <a class="c-accordion__toggle hide-for-print" data-js="simple-toggle" href="#apply-by-phone-{{ post.program_code }}">
              <span data-css-text="+ {{__('show this list', 'accessnyc-program-detail')}}"
                    data-css-active-text="- {{__('hide this list', 'accessnyc-program-detail')}}">
            </a>
          </header>
          <div class="c-accordion__body hidden hidden-by-overflow animated active-for-print" id="apply-by-phone-{{ post.program_code }}">
            <div class="c-accordion__padding">
              {{ post.get_field('how_to_apply_or_enroll_by_phone') }}
              {{ post.get_field('phone_numbers') }}
            </div>
          </div>
        </article>

        {% endif %}

        {% if post.how_to_apply_or_enroll_in_person != '' %}

        <article class="c-accordion">
          <header class="c-accordion__header">
            <p>{{__('Apply in person', 'accessnyc-program-detail')}}</p>
            <a class="c-accordion__toggle hide-for-print" data-js="simple-toggle" href="#apply-in-person-{{ post.program_code }}">
              <span data-css-text="+ {{__('show this list', 'accessnyc-program-detail')}}"
                    data-css-active-text="- {{__('hide this list', 'accessnyc-program-detail')}}">
            </a>
          </header>
          <div class="c-accordion__body hidden hidden-by-overflow animated active-for-print" id="apply-in-person-{{ post.program_code }}">
            <div class="c-accordion__padding">
              {{ post.get_field('how_to_apply_or_enroll_in_person') }}
              {% if post.office_locations_url != '' %}
              {% if post.apply_in_person_call_to_action != '' %}
              <p class="hide-for-print">
                <a class="btn btn-secondary btn-next" href="{{ post.office_locations_url }}" target="_blank">{{ post.apply_in_person_call_to_action|striptags }}</a>
              </p>
              {% endif %}
              {% endif %}
            </div>
          </div>
        </article>

        {% endif %}

      </div>
      {% endif %}

      {% endfor %}

      <div>
        <h3>{{__('More ways to get help with this program', 'accessnyc-program-detail')}}</h3>
        {% for method in helpMethods %}
        {% if post.get_field(method) %}
        <div>
          {{ post.get_field(method) }}
        </div>
        {% endif %}
        {% endfor %}
      </div>

    </div>

  </div>

</article>


{% if post.heads_up | length %}
<style>
  {% for icon in post.get_field('heads_up_icons') %}
  .program-detail-heads-up--{{ post.program_code }} ul li:nth-child({{ loop.index }}) {
    background-image: url({{icon.icon.url}});
  }
  {% endfor %}
</style>
{% endif %}
