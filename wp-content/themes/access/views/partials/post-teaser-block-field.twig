
{% set shownHowToApply = false %}

{% set helpMethods = [
  'get_help_online',
  'get_help_by_email',
  'get_help_by_calling_311',
  'get_help_by_calling_other_than_311',
  'get_help_in_person'
] %}

<article class="p-bottom" data-code="{{ post.program_code }}">

  <div class="p-2 bg-grey-lightest d-flex">

    <div>
      {% include 'partials/category-icon.twig' with {width: '80px', height: '80px'} %}
    </div>

    <div class="w-100 p-horizontal">

      <a href="{{ post.get_permalink }}" target="_blank">
        <h3 class="program-card-title type-h4">
          {{ post.plain_language_program_name }}
        </h3>
      </a>
      {% if not short_post %}
      <p class="program-card-subtitle type-small">{{ post.program_name }} {% if post.program_acronym != '' %}({{ post.program_acronym }}){% endif %}</p>
      {% endif %}

      {{ post.brief_excerpt }}

    </div>

    <div class="d-flex fd-column jc-space-between hide-for-print">

      <div style="width:205px" class="p-bottom">
        <div id="remove-{{ post.program_code }}">
          <a class="btn btn-primary btn-small d-block" href="#confirm-{{ post.program_code }}"
            data-js="simple-toggle"
            data-hide="#remove-{{ post.program_code }}">
            {{ __('Remove Program', 'accessnyc-screener') }}
          </a>
        </div>
        <div id="confirm-{{ post.program_code }}" class="hidden" aria-hidden="true">
          <p class="type-small ta-center bottom-4">{{ __('Are you sure?', 'accessnyc-screener') }}</p>
          <div class="d-flex">
            <a class="f-1 btn btn-primary btn-small"
              data-js="remove-program"
              data-remove-code="{{ post.program_code }}">{{ __('Remove', 'accessnyc-screener') }}</a>
            <a class="f-1 btn btn-secondary btn-small m-left" href="#remove-{{ post.program_code }}"
              data-js="simple-toggle"
              data-hide="#confirm-{{ post.program_code }}">{{ __('Keep', 'accessnyc-screener') }}</a>
          </div>
        </div>
      </div>

      <div>
        <a class="btn-toggle btn" href="#program-detail-{{ post.program_code }}"
          data-js="simple-toggle">
          {{ __('Learn More', 'accessnyc-screener') }}
        </a>
      </div>

    </div>

  </div>

  <div class="p-2 d-flex hidden" id="program-detail-{{ post.program_code }}">

    <div>
      <div style="width:80px;height:80px;">&nbsp;</div>
    </div>

    <div class="w-100 p-horizontal">

      {% for section in post.get_field('show_sections') %}

      {% if section.value == 'how-it-works' %}
      <div class="m-bottom-2">
        <h3>{{__('How it Works', 'accessnyc-program-detail')}}</h3>
        {{ post.get_field('program_description') }}
      </div>
      {% endif %}

      {% if section.value == 'how-to-apply' %}
      {% set shownHowToApply = true %}
      <div class="m-bottom-2">
        <h3>{{__('How to apply', 'accessnyc-program-detail')}}</h3>
        {% if post.how_to_apply_or_enroll_online != '' %}
        <div>
          <h4>{{__('Apply online', 'accessnyc-program-detail')}}</h4>
          {{ post.get_field('how_to_apply_or_enroll_online') }}
          {% if post.apply_online_call_to_action != '' %}
            <p class="hide-for-print">
              <a class="btn btn-secondary btn-next" href="{{ post.url_of_online_application }}">{{ post.apply_online_call_to_action }}</a>
            </p>
          {% endif %}
        </div>
        {% endif %}
        {% if post.how_to_apply_or_enroll_by_mail != '' %}
        <div>
          <h4>{{__('Apply by mail', 'accessnyc-program-detail')}}</h4>
          {{ post.get_field('how_to_apply_or_enroll_by_mail') }}
          {% if post.apply_by_mail_call_to_action != '' %}
            <p class="hide-for-print">
              <a class="btn btn-secondary btn-next" href="{% if post.url_of_pdf_application_forms != '' %}{{ post.url_of_pdf_application_forms }}{% else %}{{ post.application_forms_pdfs }}{% endif %}">{{ post.apply_by_mail_call_to_action }}</a>
            </p>
          {% endif %}
        </div>
        {% endif %}
        {% if post.how_to_apply_or_enroll_by_phone != '' %}
        <div>
          <h4>{{__('Apply by phone', 'accessnyc-program-detail')}}</h4>
          {{ post.get_field('how_to_apply_or_enroll_by_phone') }}
          {{ post.get_field('phone_numbers') }}
        </div>
        {% endif %}
        {% if post.how_to_apply_or_enroll_in_person != '' %}
        <div>
          <h4>{{__('Apply in person', 'accessnyc-program-detail')}}</h4>
          {{ post.get_field('how_to_apply_or_enroll_in_person') }}
          {% if post.office_locations_url != '' %}
            {% if post.apply_in_person_call_to_action != '' %}
              <p class="hide-for-print">
                <a class="btn btn-secondary btn-next" href="{{ post.office_locations_url }}">{{ post.apply_in_person_call_to_action|striptags }}</a>
              </p>
            {% endif %}
          {% endif %}
        </div>
        {% endif %}
      </div>
      {% endif %}

      {% endfor %}

      {% if shownHowToApply == false %}
      <div class="m-bottom-2">
        <h3>{{__('More ways to get help with this program', 'accessnyc-program-detail')}}</h3>
        {% for method in helpMethods %}
        {% if post.get_field(method) %}
        <div>
          {{ post.get_field(method) }}
        </div>
        {% endif %}
        {% endfor %}
      </div>
      {% endif %}

      {% if post.heads_up | length %}
      <div class="program-detail-heads-up program-detail-heads-up--{{ post.program_code }}">
        <h3>{{__('Heads Up', 'accessnyc-program-detail')}}</h3>
        {{ post.get_field('heads_up') }}
      </div>
      {% endif %}

    </div>

  </div>

</article>


{% if post.heads_up | length %}
<style>
  {% for icon in post.get_field('heads_up_icons') %}
  .program-detail-heads-up--{{ post.program_code }} ul li:nth-child({{ loop.index }}) {
    background-image: url({{icon.icon.url}});
  }
  {% endfor %}
</style>
{% endif %}
