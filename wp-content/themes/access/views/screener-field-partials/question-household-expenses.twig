{% set expenseOptions = [
  {'value': 'ChildCare', 'text': 'Child Care'},
  {'value': 'ChildSupport', 'text': 'Child Support (Paid)'},
  {'value': 'Cooling', 'text': 'Cooling'},
  {'value': 'DependentCare', 'text': 'Dependent Care'},
  {'value': 'Heating', 'text': 'Heating'},
  {'value': 'Medical', 'text': 'Medical expense'},
  {'value': 'Mortgage', 'text': 'Mortgage'},
  {'value': 'Rent', 'text': 'Rent'},
  {'value': 'Telephone', 'text': 'Telephone'},
  {'value': 'InsurancePremiums', 'text': 'Third Party Insurance Premiums'},
  {'value': 'Utilities', 'text': 'Utilities'}
] %}

{% set frequencyOptions = [
  {'value': 'weekly', 'text': 'Every week'},
  {'value': 'biweekly', 'text': 'Every 2 weeks'},
  {'value': 'monthly', 'text': 'Every month'},
  {'value': 'semimonthly', 'text': 'Every 2 months'},
  {'value': 'yearly', 'text': 'Every year'}
] %}

<fieldset class="d-block w-100">

  <div class="bg-grey-lightest b-bottom b-4 b-white p-relative" id="question-household-expenses">

    <div class="bg-blue-light ui-overlay js-toggle-question hidden"></div> {# hidden #}

    <div class="p-relative">

      <a class="{{styles.questions}}" data-js="question" href="#question-household-expenses">
        {{ __('Household Expenses', 'accessnyc-screener') }}
        <svg class="{{styles.warning}}" role="img" aria-label="{{ __('Some required fields are not filled out', 'accessnyc-screener') }}"
          v-if="errors.all('HouseholdExpenses').length > 0">
          <title>{{ __('Some required fields are not filled out', 'accessnyc-screener') }}</title>
          <use xlink:href="#icon-warning"></use>
        </svg>
      </a>

      <div class="p-horizontal-2 p-bottom js-toggle-question hidden"> {# hidden #}

        <div v-if="singleOccupant()">

          <div>
            <label class="{{styles.labels}}">
              <span v-if="singleOccupant()">
                {{ __('Which of these expenses apply to you?', 'accessnyc-screener') }}
              </span>
            </label>
            <div class="screener-checkboxes">
              {% for option in expenseOptions %}
              <label class="screener-checkbox styled-checkbox screener-checkboxes-program screener-label">
                <input type="checkbox" value="{{ option.value }}"
                  data-object="people"
                  data-index="0"
                  data-key="expenses"
                  v-on:change="pushPayment"
                  v-bind:checked="getPayment('people', 0, 'expenses', '{{ option.value }}')">
                <span class="styled-checkbox-label">
                  {{ option.text }}
                </span>
              </label>
              {% endfor %}
            </div>
          </div>

          <div v-for="(expense, expenseIndex) in people[0]._attrs.expenses">

            <div class="p-top p-bottom-2">
              <hr class="m-0 screener-divider">
            </div>

            <div class="m-bottom-2">
              <label class="{{styles.labels}}">
                {{ __('How much do you pay for: ', 'accessnyc-screener') }}
                <span class="c-blue">v{ localString(expense.type) }</span>{{ __('?') }}
                <span class="c-red">*</span>
              </label>
              <div class="screener-question-container"
                v-bind:class="{'error': errors.has('HouseholdExpenses.Person[0].expenses[' + expenseIndex + '].amount')}">
                <div class="error-message"
                  v-if="errors.has('HouseholdExpenses.Person[0].expenses[' + expenseIndex + '].amount')">
                    v{ errors.first('HouseholdExpenses.Person[0].expenses[' + expenseIndex + '].amount') }
                </div>
                <div class="currency-usd m-0">
                  <input type="text" pattern="\d*" required
                    data-type="float"
                    data-vv-scope="HouseholdExpenses"
                    data-vv-as="{{ __('expense amount', 'accessnyc-screener') }}"
                    data-js="calc-input,format-dollars"
                    data-js-regex="^([0-9]{1,6})(\.[0-9]{0,2})?$"
                    v-bind:id="'person-0-expenses-' + expenseIndex + '-amount'"
                    v-bind:name="'Person[0].expenses[' + expenseIndex + '].amount'"
                    v-validate="{required: true, regex: '^([0-9]{1,6})(\.[0-9]{0,2})?$', max: 9, decimal: 2}"
                    v-model.lazy="expense.amount">
                </div>
              </div>
            </div>

            <div>
              <label class="{{styles.labels}}"
                v-bind:for="'person-0-expenses-' + expenseIndex + '-frequency'">
                {{ __('How often do you pay for: ', 'accessnyc-screener') }}
                <span class="c-blue">v{ localString(expense.type) }</span>{{ __('?') }}
                <span class="c-red">*</span>
              </label>
              <div class="screener-question-container"
                v-bind:class="{'error': errors.has('Person[0].expenses[' + expenseIndex + '].frequency', 'HouseholdExpenses')}">
                <div class="error-message"
                  v-if="errors.has('Person[0].expenses[' + expenseIndex + '].frequency', 'HouseholdExpenses')">
                    v{ errors.first('Person[0].expenses[' + expenseIndex + '].frequency', 'HouseholdExpenses') }
                </div>
                <div class="screener-checkboxes">
                  {% for frequency in frequencyOptions %}
                  <label class="screener-checkbox styled-radio screener-checkboxes-program screener-label"
                    v-bind:for="'person-0-expenses-' + expenseIndex + '-frequency-{{ frequency.value }}'">
                    <input type="radio" value="{{ frequency.value }}"
                      data-vv-as="{{ __('expense frequency', 'accessnyc-screener') }}"
                      data-vv-scope="HouseholdExpenses"
                      v-model="expense.frequency"
                      v-validate="{required: true}"
                      v-bind:id="'person-0-expenses-' + expenseIndex + '-frequency-{{ frequency.value }}'"
                      v-bind:name="'Person[0].expenses[' + expenseIndex + '].frequency'">
                    <span class="styled-radio-label">
                      {{ __(frequency.text, 'accessnyc-screener') }}
                    </span>
                  </label>
                  {% endfor %}
                </div>
              </div>
            </div>

          </div>

        </div>
        <div v-else>

          <div>
            <label class="{{styles.labels}}">
              {{ __('What expenses did your household have most recently?', 'accessnyc-screener') }}
            </label>
            <div class="screener-checkboxes">
              {% for option in expenseOptions %}
              <label class="screener-checkbox styled-checkbox screener-checkboxes-program screener-label">
                <input type="checkbox" value="{{ option.value }}"
                  data-object="expenses"
                  v-on:change="push"
                  v-bind:checked="checked('expenses', '{{ option.value }}')">
                <span class="styled-checkbox-label">
                  {{ option.text }}
                </span>
              </label>
              {% endfor %}
            </div>
          </div>

          {% for expense in expenseOptions %}
          <div v-if="checked('expenses', '{{ expense.value }}')">

            <div class="p-top p-bottom-2">
              <hr class="m-0 screener-divider">
            </div>

            <div>
              <label class="{{styles.labels}}">
                {{ __('Who contributes to', 'accessnyc-screener') }}: <span class="c-blue">{{ __(expense.text, 'accessnyc-screener') }}</span>{{ __('?') }}
              </label>
              <div class="m-bottom-2">
                <label class="styled-checkbox screener-checkbox screener-label" v-for="(p, personIndex) in people">
                  <input type="checkbox"
                    data-object="people"
                    data-key="expenses"
                    value="{{ expense.value }}"
                    v-bind:data-index="personIndex"
                    v-on:change="pushPayment"
                    v-bind:checked="getPayment('people', personIndex, 'expenses', '{{ expense.value }}')">
                  <span class="styled-checkbox-label">
                    <personlabel v-bind:index="personIndex" v-bind:person="p._attrs"></personlabel>
                  </span>
                </label>
              </div>
            </div>

            <div v-for="(p, personIndex) in people">
              <div v-for="(e, expenseIndex) in p._attrs.expenses" v-if="e.type === '{{ expense.value }}'">

                <div class="m-bottom-2">
                  <label class="{{styles.labels}}">
                    {{ __('How much', 'accessnyc-screener') }}
                    <span v-if="personIndex == 0">{{ __('do', 'accessnyc-screener') }}</span>
                    <span v-else>{{ __('does', 'accessnyc-screener') }}</span>
                    <personlabel v-bind:index="personIndex" v-bind:person="p._attrs"></personlabel>
                    {{ __('contribute to', 'accessnyc-screener') }}: <span class="c-blue">{{ __(expense.text, 'accessnyc-screener') }}</span>{{ __('?') }}
                    <span class="c-red">*</span>
                  </label>
                  <div class="screener-question-container"
                    v-bind:class="{'error': errors.has('HouseholdExpenses.Person[' + personIndex + '].expenses[' + expenseIndex + '].amount')}">
                    <div class="error-message"
                      v-if="errors.has('HouseholdExpenses.Person[' + personIndex + '].expenses[' + expenseIndex + '].amount')">
                        v{ errors.first('HouseholdExpenses.Person[' + personIndex + '].expenses[' + expenseIndex + '].amount') }</div>
                    <div class="currency-usd m-0">
                      <input required
                        data-type="float"
                        data-vv-scope="HouseholdExpenses"
                        v-bind:id="'person-' + personIndex + '-expenses-' + expenseIndex + '-amount'"
                        v-bind:name="'Person[' + personIndex + '].expenses[' + expenseIndex + '].amount'"
                        v-bind:data-vv-as="e.type + ' expense amount'"
                        v-validate="{required: true, regex: '[0-9.]'}"
                        v-model.number="e.amount">
                    </div>
                  </div>
                </div>

                <div>
                  <label class="{{styles.labels}}"
                    v-bind:for="'person-' + personIndex + '-expenses--frequency'">
                    {{ __('How often do', 'accessnyc-screener') }}
                    <personlabel v-bind:index="personIndex" v-bind:person="p._attrs"></personlabel>
                    {{ __('contribute to', 'accessnyc-screener') }}: <span class="c-blue">{{ __(expense.text, 'accessnyc-screener') }}</span>{{ __('?') }}
                  </label>
                  <div class="screener-question-container"
                    v-bind:class="{'error': errors.has('Person[' + personIndex + '].expenses[' + expenseIndex + '].frequency', 'HouseholdExpenses')}">
                    <div class="error-message"
                      v-if="errors.has('Person[' + personIndex + '].expenses[' + expenseIndex + '].frequency', 'HouseholdExpenses')">
                        v{ errors.first('Person[' + personIndex + '].expenses[' + expenseIndex + '].frequency', 'HouseholdExpenses') }
                    </div>
                    <div class="screener-checkboxes">
                      {% for frequency in frequencyOptions %}
                      <label class="screener-checkbox styled-radio screener-checkboxes-program screener-label"
                        v-bind:for="'person-' + personIndex + '-expenses-' + expenseIndex + '-frequency-{{ frequency.value }}'">
                        <input type="radio" value="{{ frequency.value }}"
                          data-vv-scope="HouseholdExpenses"
                          data-vv-as="{{ __('expense frequency', 'accessnyc-screener') }}"
                          v-model="e.frequency"
                          v-validate="{required: true}"
                          v-bind:id="'person-' + personIndex + '-expenses-' + expenseIndex + '-frequency-{{ frequency.value }}'"
                          v-bind:name="'Person[' + personIndex + '].expenses[' + expenseIndex + '].frequency'">
                        <span class="styled-radio-label">
                          {{ __(frequency.text, 'accessnyc-screener') }}
                        </span>
                      </label>
                      {% endfor %}
                    </div>
                  </div>
                </div>

              </div>
            </div>

          </div>
          {% endfor %}

        </div>

      </div>

    </div>

  </div>

</fieldset>
